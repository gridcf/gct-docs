<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Grid Community Toolkit: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Grid Community Toolkit
   &#160;<span id="projectnumber">6.2.1566487665 (tag: v6.2.20190829)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><p>GRAM Protocol Definition</p>
<p>The GRAM Protocol is used to handle communication between the Gatekeeper, Job Manager, and GRAM Clients. The protocol is based on a subset of the HTTP/1.1 protocol, with a small set of message types and responses sent as the body of the HTTP requests and responses. This document describes GRAM Protocol version 2.</p>
<h2>Framing</h2>
<p>GRAM messages are framed in HTTP/1.1 messages. However, only a small subset of the HTTP specification is used or understood by the GRAM system. All GRAM requests are HTTP POST messages. Only the following HTTP headers are understood:</p><ul>
<li>Host</li>
<li>Content-Type (set to "application/x-globus-gram" in all cases)</li>
<li>Content-Length</li>
<li>Connection (set to "close" in all HTTP responses)</li>
</ul>
<p>Only the following status codes are supported in response's HTTP Status-Lines:</p><ul>
<li>200 OK</li>
<li>403 Forbidden</li>
<li>404 Not Found</li>
<li>500 Internal Server Error</li>
<li>400 Bad Request</li>
</ul>
<h2>Message Format</h2>
<p>All messages use the carriage return (ASCII value 13) followed by line feed (ASCII value 10) sequence to delimit lines. In all cases, a blank line separates the HTTP header from the message body. All <b>application/x-globus-gram</b> message bodies consist of attribute names followed by a colon, a space, and then the value of the attribute. When the value may contain a newline or double-quote character, a special escaping rule is used to encapsulate the complete string. This encapsulation consists of surrounding the string with double-quotes, and escaping all double-quote and backslash characters within the string with a backslash. All other characters are sent without modification. For example, the string </p><div class="fragment"><div class="line">rsl: &amp;( executable = <span class="stringliteral">&quot;/bin/echo&quot;</span> )</div><div class="line"> ( arguments = <span class="stringliteral">&quot;hello&quot;</span> )</div></div><!-- fragment --><p> becomes </p><div class="fragment"><div class="line">rsl: <span class="stringliteral">&quot;&amp;( executable = \&quot;bin/echo\&quot; )</span></div><div class="line"><span class="stringliteral">  (arguments = \&quot;hello\&quot; )&quot;</span></div></div><!-- fragment --><p>This is the only form of quoting which <b>application/x-globus-gram</b> messages support. Use of % HEX HEX escapes (such as seen in URL encodings) is not meaningful for this protocol.</p>
<h2>Message Types</h2>
<h3>Ping Request</h3>
<p>A ping request is used to verify that the gatekeeper is configured properly to handle a named service. The ping request consists of the following:</p>
<pre>
    POST ping/<em>job-manager-name</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
</pre><p>The values of the message-specific strings are </p><dl>
<dt><em>job-manager-name</em> </dt>
<dd>The name of the service to have the gatekeeper check. The service name corresponds to one of the gatekeeper's configured grid-services, and is usually of the form "jobmanager-&lt;em&gt;scheduler-type&lt;/em&gt;". </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the gatekeeper is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
</dl>
<h3>Job Request</h3>
<p>A job request is used to scheduler a job remotely using GRAM. The ping request consists of the HTTP framing described above with the request-URI consisting of <em>job-manager-name</em>, where <em>job-manager name</em> is the name of the service to use to schedule the job. The format of a job request message consists of the following:</p>
<pre>
    POST <em>job-manager-name</em>[@<em>user-name</em>] HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    job-state-mask: <em>mask</em>
    callback-url: <em>callback-contact</em>
    rsl: <em>rsl-description</em>
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-manager-name</em> </dt>
<dd>The name of the service to submit the job request to. The service name corresponds to one of the gatekeeper's configured grid-services, and is usually of the form "jobmanager-&lt;em&gt;scheduler-type&lt;/em&gt;". </dd>
<dt><em>user-name</em> </dt>
<dd>Starting with GT4.0, a client may request that a certain account by used by the gatekeeper to start the job manager. This is done optionally by appending the @ symbol and the local user name that the job should be run as to the <em>job-manager-name</em>. If the @ and username are not present, then the first grid map entry will be used. If the client credential is not authorized in the grid map to use the specified account, an authorization error will occur in the gatekeeper. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the gatekeeper is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
<dt><em>mask</em> </dt>
<dd>An integer representation of the job state mask. This value is obtained from a bitwise-OR of the job state values which the client wishes to receive job status callbacks about. These meanings of the various job state values are defined in the <a class="el" href="group__globus__gram__protocol__job__state.html#globus_gram_protocol_job_state_t">GRAM Protocol API documentation</a>.  </dd>
<dt><em>callback-contact</em> </dt>
<dd>A https URL which defines a GRAM protocol listener which will receive job state updates. The from a bitwise-OR of the job state values which the client wishes to receive job status callbacks about. The job status update messages are defined <a class="el" href="globus_gram_protocol_definition.html#globus_gram_protocol_job_state_updates">below</a>. </dd>
<dt><em>rsl-description</em> </dt>
<dd>A quoted string containing the RSL description of the job request. </dd>
</dl>
<h3>Status Request</h3>
<p>A status request is used by a GRAM client to get the current job state of a running job. This type of message can only be sent to a job manager's job-contact (as returned in the reply to a job request message). The format of a job request message consists of the following: </p><pre>
    POST <em>job-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "status"
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-contact</em> </dt>
<dd>The job contact string returned in a response to a job request message, or determined by querying the MDS system. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the job manager is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
</dl>
<h3>Callback Register Request</h3>
<p>A callback register request is used by a GRAM client to register a new callback contact to receive GRAM job state updates. This type of message can only be sent to a job manager's job-contact (as returned in the reply to a job request message). The format of a job request message consists of the following: </p><pre>
    POST <em>job-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "register &lt;em&gt;mask&lt;/em&gt; &lt;em&gt;callback-contact&lt;/em&gt;"
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-contact</em> </dt>
<dd>The job contact string returned in a response to a job request message, or determined by querying the MDS system. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the job manager is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
<dt><em>mask</em> </dt>
<dd>An integer representation of the job state mask. This value is obtained from a bitwise-OR of the job state values which the client wishes to receive job status callbacks about. These meanings of the various job state values are defined in the <a class="el" href="group__globus__gram__protocol__job__state.html#globus_gram_protocol_job_state_t">GRAM Protocol API documentation</a>.  </dd>
<dt><em>callback-contact</em> </dt>
<dd>A https URL which defines a GRAM protocol listener which will receive job state updates. The from a bitwise-OR of the job state values which the client wishes to receive job status callbacks about. The job status update messages are defined <a class="el" href="globus_gram_protocol_definition.html#globus_gram_protocol_job_state_updates">below</a>.  </dd>
</dl>
<h3>Callback Unregister Request</h3>
<p>A callback unregister request is used by a GRAM client to request that the job manager no longer send job state updates to the specified callback contact. This type of message can only be sent to a job manager's job-contact (as returned in the reply to a job request message). The format of a job request message consists of the following: </p><pre>
    POST <em>job-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "unregister &lt;em&gt;callback-contact&lt;/em&gt;"
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-contact</em> </dt>
<dd>The job contact string returned in a response to a job request message, or determined by querying the MDS system. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the job manager is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
<dt><em>callback-contact</em> </dt>
<dd>A https URL which defines a GRAM protocol listener which should no longer receive job state updates. The from a bitwise-OR of the job state values which the client wishes to receive job status callbacks about. The job status update messages are defined <a class="el" href="globus_gram_protocol_definition.html#globus_gram_protocol_job_state_updates">below</a>.  </dd>
</dl>
<h3>Job Cancel Request</h3>
<p>A job cancel request is used by a GRAM client to request that the job manager terminate a job. This type of message can only be sent to a job manager's job-contact (as returned in the reply to a job request message). The format of a job request message consists of the following: </p><pre>
    POST <em>job-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "cancel"
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-contact</em> </dt>
<dd>The job contact string returned in a response to a job request message, or determined by querying the MDS system. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the job manager is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
</dl>
<h3>Job Signal Request</h3>
<p>A job signal request is used by a GRAM client to request that the job manager process a signal for a job. The arguments to the various signals are discussed in the <a class="el" href="group__globus__gram__protocol__job__signal.html#globus_gram_protocol_job_signal_t">globus_gram_protocol_job_signal_t</a> documentation. </p><pre>
    POST <em>job-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "&lt;em&gt;signal&lt;/em&gt;"
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>job-contact</em> </dt>
<dd>The job contact string returned in a response to a job request message, or determined by querying the MDS system. </dd>
<dt><em>host-name</em> </dt>
<dd>The name of the host on which the job manager is running. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
<dt><em>signal</em> </dt>
<dd>A quoted string containing the signal number and it's parameters. </dd>
</dl>
<p><a class="anchor" id="globus_gram_protocol_job_state_updates"></a></p><h3>Job State Updates</h3>
<p>A job status update message is sent by the job manager to all registered callback contacts when the job's status changes. The format of the job status update messages is as follows: </p><pre>
    POST <em>callback-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    job-manager-url: <em>job-contact</em>
    status: <em>status-code</em>
    failure-code: <em>failure-code</em>
</pre><p>The values of the emphasized text items are as below: </p><dl>
<dt><em>callback-contact</em> </dt>
<dd>The callback contact string registered with the job manager either by being passed as the <em>callback-contact</em> in a job request message or in a callback register message. </dd>
<dt><em>host-name</em> </dt>
<dd>The host part of the callback-contact URL. This exists only for compatibility with the HTTP/1.1 protocol. </dd>
<dt><em>message-size</em> </dt>
<dd>The length of the content of the message, not including the HTTP/1.1 header. </dd>
<dt><em>version</em> </dt>
<dd>The version of the GRAM protocol which is being used. For the protocol defined in this document, the value must be the string "2". </dd>
<dt><em>job-contact</em> </dt>
<dd>The job contact of the job which has changed states. </dd>
</dl>
<p><a class="anchor" id="globus_gram_protocol_delegation"></a></p><h3>Proxy Delegation</h3>
<p>A proxy delegation message is sent by the client to the job manager to initiate a delegation handshake to generate a new proxy credential for the job manager. This credential is used by the job manager or the job when making further secured connections. The format of the delegation message is as follows: </p><pre>
    POST <em>callback-contact</em> HTTP/1.1
    Host: <em>host-name</em>
    Content-Type: application/x-globus-gram
    Content-Length: <em>message-size</em></pre><pre>    protocol-version: <em>version</em>
    "renew"
</pre><p>If a successful (200) reply is sent in response to this message, then the client will procede with a GSI delegation handshake. The tokens in this handshake will be framed with a 4 byte big-endian token length header. The framed tokens will then be wrapped using the GLOBUS_IO_SECURE_CHANNEL_MODE_SSL_WRAP wrapping mode. The job manager will frame response tokens in the same manner. After the job manager receives its final delegation token, it will respond with another response message that indicates whether the delegation was processed or not. This response message is a standard GRAM response message.</p>
<h4>Note on Security Attributes</h4>
<p>The following security attributes are needed to communicate with the Gatekeeper:</p><ul>
<li>Authentication must be done using GSSAPI mutual authentication</li>
<li>Messages must be wrapped with support for the delegation message. When using Globus I/O, this is accomplished by using the the GLOBUS_IO_SECURE_CHANNEL_MODE_GSI_WRAP wrapping mode.</li>
</ul>
<h4>Changes</h4>
<p>2004-08-11 Added information about gridmap choosing </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
